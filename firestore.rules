/**
 * @description This ruleset enforces a public-access model for all data. Any authenticated or unauthenticated client can read or write any data.
 * @dataStructure
 *  - /users/{userId}: Stores user profile information.
 *  - /sensor_configurations/{sensorConfigurationId}: Stores sensor configurations.
 *  - /sensor_configurations/{sensorConfigurationId}/sensor_data/{sensorDataId}: Stores sensor data associated with configurations.
 *  - /analysis_results/{analysisResultId}: Stores analysis results.
 *  - /test_sessions/{testSessionId}: Stores test session data.
 * @keySecurityDecisions
 *  - No user-specific authorization is enforced. All collections are globally readable and writable.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows any signed-in user to read and write user profiles.
     * @path /users/{userId}
     * @allow (get, list) Authenticated or unauthenticated user can read user profiles.
     * @allow (create, update, delete) Authenticated or unauthenticated user can write user profiles.
     * @deny None.
     * @principle Open access: all users can read and write user data.
     */
    match /users/{userId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }

    /**
     * @description Allows any signed-in user to read and write sensor configurations.
     * @path /sensor_configurations/{sensorConfigurationId}
     * @allow (get, list) Authenticated or unauthenticated user can read sensor configurations.
     * @allow (create, update, delete) Authenticated or unauthenticated user can write sensor configurations.
     * @deny None.
     * @principle Open access: all users can read and write sensor configuration data.
     */
    match /sensor_configurations/{sensorConfigurationId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }

    /**
     * @description Allows any signed-in user to read and write sensor data.
     * @path /sensor_configurations/{sensorConfigurationId}/sensor_data/{sensorDataId}
     * @allow (get, list) Authenticated or unauthenticated user can read sensor data.
     * @allow (create, update, delete) Authenticated or unauthenticated user can write sensor data.
     * @deny None.
     * @principle Open access: all users can read and write sensor data.
     */
    match /sensor_configurations/{sensorConfigurationId}/sensor_data/{sensorDataId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }

    /**
     * @description Allows any signed-in user to read and write analysis results.
     * @path /analysis_results/{analysisResultId}
     * @allow (get, list) Authenticated or unauthenticated user can read analysis results.
     * @allow (create, update, delete) Authenticated or unauthenticated user can write analysis results.
     * @deny None.
     * @principle Open access: all users can read and write analysis result data.
     */
    match /analysis_results/{analysisResultId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }

    /**
     * @description Allows any signed-in user to read and write test sessions.
     * @path /test_sessions/{testSessionId}
     * @allow (get, list) Authenticated or unauthenticated user can read test sessions.
     * @allow (create, update, delete) Authenticated or unauthenticated user can write test sessions.
     * @deny None.
     * @principle Open access: all users can read and write test session data.
     */
    match /test_sessions/{testSessionId} {
      allow get, list: if true;
      allow create, update, delete: if true;
    }
  }
}